


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xml:lang="" lang="" version="-//W3C//DTD XHTML 1.1//EN" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <title>Plantilla plan de servicio &mdash; documentación de techDocTLPZ - 0.0.1.a</title>
  

  

  

    <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'/>
    <link rel="stylesheet" href="../_static/css/pdj.css" type="text/css" />

  

  
        <link rel="index" title="Índice"
              href="../genindex.html"/>
        <link rel="search" title="Búsqueda" href="../search.html"/>
    <link rel="top" title="documentación de techDocTLPZ - 0.0.1.a" href="../index.html"/>
        <link rel="next" title="ORDERFLOW" href="orderflow_2.html"/>
        <link rel="prev" title="Welcome to techDocTLPZ’s documentation!" href="../index.html"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="cache-control" content="public" />
    <meta name="robots" content="follow, all" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Add jQuery library -->
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

  </head>

  <body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="fa fa-home"> techDocTLPZ </a>
        <div role="search">
	  <form id ="rtd-search-form" class="wy-form"
		action="../search.html" method="get">
	    <input type="text" name="q" placeholder="Search docs" />
	    <input type="hidden" name="check_keywords" value="yes" />
	    <input type="hidden" name="area" value="default" />
	  </form>
	</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	
          
          
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#"><strong>Plantilla plan de servicio</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduccion">1. INTRODUCCIÓN</a></li>
<li class="toctree-l2"><a class="reference internal" href="#flujo-de-creacion-de-pedido-basico">2. FLUJO DE CREACIÓN DE PEDIDO BÁSICO</a></li>
<li class="toctree-l2"><a class="reference internal" href="#flujo-de-creacion-de-un-pedido-de-kiosco">FLUJO DE CREACIÓN DE UN PEDIDO DE KIOSCO</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inicio-de-pedido">4. INICIO DE PEDIDO</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tiendas-por-localizacion">TIENDAS POR LOCALIZACIÓN</a></li>
<li class="toctree-l2"><a class="reference internal" href="#horas-disponibles">HORAS DISPONIBLES</a></li>
<li class="toctree-l2"><a class="reference internal" href="#obtener-catalogo">OBTENER CATÁLOGO</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creacion-del-pedido">8. CREACIÓN DEL PEDIDO</a></li>
<li class="toctree-l2"><a class="reference internal" href="#anadir-un-producto">9. AÑADIR UN PRODUCTO</a></li>
<li class="toctree-l2"><a class="reference internal" href="#establecer-una-direccion-de-entrega">10. ESTABLECER UNA DIRECCIÓN DE ENTREGA</a></li>
<li class="toctree-l2"><a class="reference internal" href="#obtener-medios-de-pago">11. OBTENER MEDIOS DE PAGO</a></li>
<li class="toctree-l2"><a class="reference internal" href="#finalizar-pedido">12. FINALIZAR PEDIDO</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="orderflow_2.html">ORDERFLOW</a></li>
</ul>

          
        

      </div>
      &nbsp;
    </nav>
    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      <nav class="wy-nav-top" id="barra-mobile" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="#">Porão do Juca</a>
      </nav>

      <div class="wy-nav-content">
	<div class="fundo-claro">
	</div>
	<div class="fundo-escuro">
	</div>

        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
	    
	    <!-- <ul class="wy-breadcrumbs"> -->
	    <!--   <li><a href="#">Docs</a> &raquo;</li> -->

	    <!--   <li>Features</li> -->
	    <!--   <li class="wy-breadcrumbs-aside"> -->

	    <!-- 	<a href="_sources/index.txt" rel="nofollow"> View page source</a> -->

	    <!--   </li> -->
	    <!-- </ul> -->
	    <!-- <hr/> -->
	  </div>

          <div role="main" class="">

	    <div id="content" class="hfeed entry-container hentry">
  <p><a class="reference internal" href="docs\media/image1.jpg"><img alt="image0" src="docs\media/image1.jpg" style="width: 1.13333in; height: 0.48611in;" /></a></p>
<p><a class="reference internal" href="docs\media/image2.jpg"><img alt="image1" src="docs\media/image2.jpg" style="width: 2.05in; height: 1.06232in;" /></a></p>
<p><a class="reference internal" href="docs\media/image3.jpg"><img alt="image2" src="docs\media/image3.jpg" style="width: 7.875in; height: 7.2416in;" /></a></p>
<div class="section" id="plantilla-plan-de-servicio">
<h1><strong>Plantilla plan de servicio</strong><a class="headerlink" href="#plantilla-plan-de-servicio" title="Enlazar permanentemente con este título">¶</a></h1>
<p><strong>ÍNDICE</strong></p>
<ol class="arabic">
<li><p><strong>INTRODUCCIÓN</strong></p></li>
<li><p><strong>FLUJO DE CREACIÓN DE PEDIDO BÁSICO</strong></p></li>
<li><p><strong>FLUJO DE CREACIÓN DE UN PEDIDO DE KIOSCO</strong></p></li>
<li><p><strong>INICIO DE PEDIDO</strong></p>
<p><em>Los parámetros de entrada son:</em></p>
<p><em>Ejemplo de respuesta:</em></p>
</li>
<li><p><strong>TIENDAS POR LOCALIZACIÓN</strong></p>
<p><em>Los parámetros de entrada son:</em></p>
<p><em>Ejemplo de respuesta:</em></p>
</li>
<li><p><strong>HORAS DISPONIBLES</strong></p>
<blockquote>
<div><p><em>Los parámetros de entrada son:</em></p>
<p><em>Ejemplo de respuesta:</em></p>
</div></blockquote>
</li>
<li><p><strong>OBTENER CATÁLOGO</strong></p>
<blockquote>
<div><p><em>Los parámetros de entrada son:</em></p>
<p><em>Ejemplo de respuesta:</em></p>
<p><em>Los parámetros de entrada son:</em></p>
</div></blockquote>
<dl class="simple">
<dt><a href="#id1"><span class="problematic" id="id2">`7.1 OBTENER LOS INGREDIENTES ELEGIBLES PARA UN PRODUCTO`__</span></a></dt><dd><p><em>Los parámetros de entrada son:</em></p>
</dd>
</dl>
<p><em>Ejemplo de respuesta:</em></p>
</li>
<li><p><strong>CREACIÓN DEL PEDIDO</strong>
<em>El parámetro de entrada es:</em></p>
<p><em>El parámetro de entrada es:</em></p>
</li>
<li><p><strong>AÑADIR UN PRODUCTO</strong></p>
<p><em>Los parámetros de entrada son:</em></p>
<p><em>Ejemplo de parámetros de entrada:</em></p>
<p><em>Ejemplo de respuesta:</em></p>
</li>
<li><p><strong>ESTABLECER UNA DIRECCIÓN DE ENTREGA</strong></p></li>
</ol>
<blockquote>
<div><p><em>Los parámetros de entrada son:</em></p>
<p><em>Los parámetros de salida son:</em></p>
<p><em>Ejemplo de respuesta:</em></p>
<p><em>Los parámetros de entrada son:</em></p>
<p><em>Ejemplo de parámetros de entrada:</em></p>
</div></blockquote>
<ol class="arabic simple" start="11">
<li><p><strong>OBTENER MEDIOS DE PAGO</strong></p></li>
</ol>
<blockquote>
<div><p><em>Los parámetros de entrada son:</em></p>
<p><em>Los parámetros de salida son:</em></p>
<p><em>Ejemplo de respuesta:</em></p>
</div></blockquote>
<ol class="arabic simple" start="12">
<li><p><strong>FINALIZAR PEDIDO</strong></p></li>
</ol>
<blockquote>
<div><p><em>Los parámetros de entrada son:</em></p>
<p><em>Ejemplo de parámetros de entrada:</em></p>
<p><em>Ejemplo de respuesta:</em></p>
<p>La información que contiene la presente propuesta es propiedad
exclusiva de Vector ITC Group No está permitida la reproducción de la
misma, salvo con autorización expresa.</p>
<p>No está permitida la distribución de la misma a personas, entidades o
empresas no mencionadas explícitamente en el panel de información de
control y versiones, salvo con autorización expresa de Vector, SL.</p>
</div></blockquote>
<div class="section" id="introduccion">
<h2>1. INTRODUCCIÓN<a class="headerlink" href="#introduccion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Este documento representa la propuesta funcional para dar respuesta a la
necesidad de Telepizza de crear un producto integrable por consumidores
externos.</p>
<p>Desde Telepizza se quiere dar la posibilidad a un usuario, que realice
un pedido a Telepizza a través de un consumidor externo.</p>
</div>
<div class="section" id="flujo-de-creacion-de-pedido-basico">
<h2>2. FLUJO DE CREACIÓN DE PEDIDO BÁSICO<a class="headerlink" href="#flujo-de-creacion-de-pedido-basico" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Para poder crear un pedido sencillo mediante la Apificación, será
necesario realizar las llamadas a los servicios en el siguiente orden
concreto:</p>
<ul class="simple">
<li><p>Token e inicio de pedido</p></li>
</ul>
<blockquote>
<div><p>POST /connect/token</p>
</div></blockquote>
<ul class="simple">
<li><p>Obtener tiendas por localización (a recoger) GET
/shop/location/{lat}/{lng}</p></li>
<li><p>Obtener horas disponibles</p></li>
</ul>
<blockquote>
<div><p>GET /shop/availablehours</p>
</div></blockquote>
<ul class="simple">
<li><p>Obtener catálogo</p></li>
</ul>
<blockquote>
<div><p>GET /catalogue/shop/{id}</p>
</div></blockquote>
<ul class="simple">
<li><p>Creación del pedido</p></li>
</ul>
<blockquote>
<div><p>POST /order/create</p>
</div></blockquote>
<ul class="simple">
<li><p>Añadir un producto</p></li>
</ul>
<blockquote>
<div><p>POST /order/product</p>
</div></blockquote>
<ul class="simple">
<li><p>Establecer los datos de reparto</p></li>
</ul>
<blockquote>
<div><p>GET /order/getaddress</p>
<p>POST /order/delivery</p>
</div></blockquote>
<ul class="simple">
<li><p>Obtener los medios de pago para la tienda GET /shop/{id}/payments</p></li>
<li><p>Finalizar el pedido</p></li>
</ul>
<blockquote>
<div><p>POST /order/save</p>
</div></blockquote>
</div>
<div class="section" id="flujo-de-creacion-de-un-pedido-de-kiosco">
<h2>FLUJO DE CREACIÓN DE UN PEDIDO DE KIOSCO<a class="headerlink" href="#flujo-de-creacion-de-un-pedido-de-kiosco" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Para poder crear un pedido de kiosko mediante la Apificación, será
necesario realizar las llamadas a los servicios en el siguiente orden
concreto:</p>
<ul class="simple">
<li><p>Token e inicio de pedido</p></li>
</ul>
<blockquote>
<div><p>POST /connect/token</p>
</div></blockquote>
<ul class="simple">
<li><p>Obtener catálogo</p></li>
</ul>
<blockquote>
<div><p>GET /catalogue/shop/{ShopId}/{DeliveryType}</p>
</div></blockquote>
<ul class="simple">
<li><p>Creación del pedido</p></li>
</ul>
<blockquote>
<div><p>POST /order/createlocal</p>
</div></blockquote>
<ul class="simple">
<li><p>Añadir un producto</p></li>
</ul>
<blockquote>
<div><p>POST /order/product</p>
</div></blockquote>
<ul class="simple">
<li><p>Finalizar el pedido</p></li>
</ul>
<blockquote>
<div><p>POST /order/savelocal</p>
</div></blockquote>
</div>
<div class="section" id="inicio-de-pedido">
<h2>4. INICIO DE PEDIDO<a class="headerlink" href="#inicio-de-pedido" title="Enlazar permanentemente con este título">¶</a></h2>
<blockquote>
<div><p>POST /connect/token</p>
</div></blockquote>
<p>Esta llamada se encarga de obtener un token de seguridad para autorizar
las invocaciones a las llamadas y será obligatorio usarlo en todas las
llamadas.</p>
<p>La invocación a esta llamada será la primera que se realice antes de
poder realizar cualquier otra dentro del servicio.</p>
<p>Los parámetros de entrada son:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 70%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parámetro</p></th>
<th class="head"><p>Descripción</p></th>
<th class="head"><p>Ejemplo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>x-consumer</strong></p></td>
<td><p>Token del consumidor codificado en Base64</p></td>
<td><p>Base64(“prueba”) =</p>
<p>“cHJ1ZWJhOkFwaWZpY2F0aW9u”</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>grant_type</strong></p></td>
<td><p>Tipo de permiso</p></td>
<td><p>client_credentials</p></td>
</tr>
<tr class="row-even"><td><p><strong>scope</strong></p></td>
<td><p>Para pedir acceso a los recursos con un determinado rol de lectura, escritura, sólo de acceso, etc.</p></td>
<td><p>“ALL”</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Device</strong></p></td>
<td><p>Tipo de dispositivo que interactúa con el servicio. (tablet, ipad, smartphone o mobile)</p></td>
<td><p>“tablet”</p></td>
</tr>
<tr class="row-even"><td><p><strong>Culture</strong></p></td>
<td><p>Cultura. (es_es, es_en, es_ca, …)</p></td>
<td><p>“es_es”</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Language</strong></p></td>
<td><p>Idioma en el que se mostrará la información</p></td>
<td><p>“es”</p></td>
</tr>
</tbody>
</table>
<p>La respuesta contendrá el token que se usará en las llamadas posteriores
y se corresponderá con el campo <strong>x-auth-back</strong> en los parámetros de
entrada del resto de llamadas. Este token será válido durante un periodo
de tiempo y dentro del ámbito del pedido en curso.</p>
<blockquote>
<div><p>Ejemplo de respuesta:</p>
<p>{</p>
<p>«access_token»:</p>
<p>«eyJhbGciOiJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2IiwidHlwIjoiSldUIn
0.eyJuYmYiOjE1NTYxMDE0ODQsImV4cCI6MTU1NjEwNTA4NCwiaXNzIjoiaHR0cDovL2FwaS1zZXJ2aWNlcy5kZXYuYXdzL
nRlbGVwaXp6YS5jb20iLCJhdWQiOlsiaHR0cDovL2FwaS1zZXJ2aWNlcy5kZXYuYXdzLnRlbGVwaXp6YS5jb20vcmVzb3Vy
Y2VzIiwiQUxMIl0sImNsaWVudF9pZCI6InRweiIsImp0aSI6IjUiLCJzY29wZSI6WyJBTEwiXX0.Q9bsxA6syMb1h3eTzRd
oG-kJlnFLP3V3P7o0r5Xlvp3FBQY7mSX832sD-TSW288aTWYERHL50drl-</p>
<p>QFD1VNVOFt0NG5drQuNFK4j8hnIUfu8NyMTF6fVPc_voi6SlEpZ5hfwdky1TWBbQYSL0rZgc1-</p>
<p>Gz3sDuyU7XPo7x1_ISj8DXikYDSp7v6LcFTNR-</p>
<p>Iz8NKCsLMvLjHs8WpkOFgFw9SlFOTYPJC7ns6O03ZZovaG2rEFLGAkZ2FAtEkMpekqiKd9TVCiKODdGFc2YRC9hdjKvb0q2
s0Qrd4sYRMp7pJVNw51ZIGR0WQ6Osz92sUo1EG69DyJGBNerUSQuhunJVw»,</p>
<p>«expires_in»: 3600,</p>
<p>«token_type»: «Bearer»</p>
<p>}</p>
</div></blockquote>
</div>
<div class="section" id="tiendas-por-localizacion">
<h2>TIENDAS POR LOCALIZACIÓN<a class="headerlink" href="#tiendas-por-localizacion" title="Enlazar permanentemente con este título">¶</a></h2>
<blockquote>
<div><p>GET /shop/location/{lat}/{lng}</p>
</div></blockquote>
<p>Obtiene los códigos de las tiendas y el coste de reparto por
localización más cercana a una latitud y longitud concreta. Esta llamada
es sólo para pedidos a recoger en tienda.</p>
<blockquote>
<div><p>Los parámetros de entrada son:</p>
</div></blockquote>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 64%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parámetro</p></th>
<th class="head"><p>Descripción</p></th>
<th class="head"><p>Ejemplo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>x-auth-back</strong></p></td>
<td><p>Autorización para el servicio con el token obtenido en la llamada al “POST</p>
<p>/connect/token”:</p>
<p>token_type + “ ” + access_token</p>
</td>
<td><p>“Bearer</p>
<p>eyJhbGciOiJodHRwOi8vd3d3…”</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>lat</strong></p></td>
<td><p>Latitud de la posición que se quiere consultar</p></td>
<td><p>“41.67246”</p></td>
</tr>
<tr class="row-even"><td><p><strong>lng</strong></p></td>
<td><p>Longitud de la posición que se quiere consultar</p></td>
<td><p>“-0.890901”</p></td>
</tr>
</tbody>
</table>
<p>Esta llamada se puede ejecutar de forma independiente al resto de
existentes.</p>
<p>La información que devuelve consta del identificador de la tienda que se
utilizará en consultas posteriores, junto con la dirección de la tienda
(calle, ciudad y provincia).</p>
<blockquote>
<div><p>Ejemplo de respuesta:</p>
<p>[</p>
<p>{</p>
<p>«shopId»: «00145»,</p>
<p>«addresss»: «Gertrudis Gómez de Avellaneda»,</p>
<p>«city»: «ZARAGOZA»,</p>
<p>«province»: «ZARAGOZA»</p>
<p>},</p>
<p>{</p>
<p>«shopId»: «00306»,</p>
<p>«addresss»: «Sobrarbe 43»,</p>
<p>«city»: «ZARAGOZA»,</p>
<p>«province»: «ZARAGOZA»</p>
<p>},</p>
<p>{</p>
<p>«shopId»: «00859»,</p>
<p>«addresss»: «Plaza del Pilar 14»,</p>
<p>«city»: «ZARAGOZA»,</p>
<p>«province»: «ZARAGOZA»</p>
<p>},</p>
<p>{</p>
<p>«shopId»: «00374»,</p>
<p>«addresss»: «Paseo María Agustín 9»,</p>
<p>«city»: «ZARAGOZA»,</p>
<p>«province»: «ZARAGOZA»</p>
<p>},</p>
<p>{</p>
<p>«shopId»: «00834»,</p>
<p>«addresss»: «Avenida de Madrid 198»,</p>
<p>«city»: «ZARAGOZA»,</p>
<p>«province»: «ZARAGOZA»</p>
<p>}</p>
</div></blockquote>
<p>]</p>
</div>
<div class="section" id="horas-disponibles">
<h2>HORAS DISPONIBLES<a class="headerlink" href="#horas-disponibles" title="Enlazar permanentemente con este título">¶</a></h2>
<blockquote>
<div><p>POST /shop/availablehours</p>
</div></blockquote>
<p>En el caso de que se informen los campos de <strong>lat</strong> y <strong>lng</strong>, se
encarga de consultar y devolver las horas disponibles de reparto a
domicilio. Si se informa el campo <strong>shopId</strong>, devolverá las horas en las
que se podrá recoger el pedido en la tienda indicada.</p>
<blockquote>
<div><p>Los parámetros de entrada son:</p>
</div></blockquote>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 63%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parámetro</p></th>
<th class="head"><p>Descripción</p></th>
<th class="head"><p>Ejemplo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>x-auth-back</strong></p></td>
<td><p>Autorización para el servicio con el token obtenido en la llamada al “POST</p>
<p>/connect/token”:</p>
<p>token_type + “ ” + access_token</p>
</td>
<td><p>“Bearer</p>
<p>eyJhbGciOiJodHRwOi8vd3d3…”</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>lat</strong></p></td>
<td><p>Latitud de la posición que se quiere consultar</p></td>
<td><p>“41.67246”</p></td>
</tr>
<tr class="row-even"><td><p><strong>lng</strong></p></td>
<td><p>Longitud de la posición que se quiere consultar</p></td>
<td><p>“-0.890901”</p></td>
</tr>
<tr class="row-odd"><td><p><strong>shopId</strong></p></td>
<td><p>Identificador de la tienda</p></td>
<td><p>“00145”</p></td>
</tr>
<tr class="row-even"><td><p><strong>deliveryType</strong></p></td>
<td><p>Tipo de reparto</p></td>
<td><ol class="arabic simple">
<li><p>– Local</p></li>
<li><p>– Domicilio</p></li>
<li><p>– Recoger en Tienda</p></li>
</ol>
</td>
</tr>
</tbody>
</table>
<p>Esta llamada se puede ejecutar de forma independiente al resto de
existentes.</p>
<p>La respuesta devolverá el listado de horas que la tienda tiene
disponibles para recoger pedidos o para envío a domicilio, junto con el
tiempo de espera entre hora y hora, configurado para la tienda asignada
a esa localización, o para la tienda indicada.</p>
<blockquote>
<div><p>Ejemplo de respuesta:</p>
<p>{</p>
<p>«availableHours»: [</p>
<p>«2019-05-27T19:05:00Z»,</p>
<p>«2019-05-27T19:20:00Z»,</p>
<p>«2019-05-27T19:35:00Z»,</p>
<p>«2019-05-27T19:50:00Z»,</p>
<p>«2019-05-27T20:05:00Z»,</p>
<p>«2019-05-27T20:20:00Z»,</p>
<p>«2019-05-27T20:35:00Z»,</p>
<p>«2019-05-27T20:50:00Z»,</p>
<p>«2019-05-27T21:05:00Z»,</p>
<p>«2019-05-27T21:20:00Z»,</p>
<p>«2019-05-27T21:35:00Z»,</p>
<p>«2019-05-27T21:50:00Z»,</p>
<p>«2019-05-27T22:05:00Z»,</p>
<p>«2019-05-27T22:20:00Z»,</p>
<p>«2019-05-27T22:35:00Z»,</p>
<p>«2019-05-27T22:50:00Z»,</p>
<p>«2019-05-27T23:05:00Z»,</p>
<p>«2019-05-27T23:20:00Z»,</p>
<p>«2019-05-27T23:35:00Z»</p>
<p>],</p>
<p>«waitTime»: 0</p>
<p>}</p>
</div></blockquote>
</div>
<div class="section" id="obtener-catalogo">
<h2>OBTENER CATÁLOGO<a class="headerlink" href="#obtener-catalogo" title="Enlazar permanentemente con este título">¶</a></h2>
<blockquote>
<div><p>GET /catalogue/shop/{id}</p>
</div></blockquote>
<p>Esta llamada se encarga de devolver todos los productos disponibles para
una tienda.</p>
<blockquote>
<div><p>Los parámetros de entrada son:</p>
</div></blockquote>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 64%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parámetro</p></th>
<th class="head"><p>Descripción</p></th>
<th class="head"><p>Ejemplo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>x-auth-back</strong></p></td>
<td><p>Autorización para el servicio con el token obtenido en la llamada al “POST</p>
<p>/connect/token”: token_type + “ ” + access_token</p>
</td>
<td><p>“Bearer</p>
<p>eyJhbGciOiJodHRwOi8vd3d3…”</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Id</strong></p></td>
<td><p>Código identificador de la tienda.</p></td>
<td><p>“00145”</p></td>
</tr>
</tbody>
</table>
<p>Dentro de la respuesta se encuentra el listado de productos agrupados
por categorías y subcategorías. Y a su vez, dentro de cada producto
podrán haber definidos diferentes tamaños del producto elegibles del
listado, ingredientes por defecto de cada producto (podrán ser añadidos)
y diferentes tamaños de masa también elegibles, entre otros campos.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 9%" />
<col style="width: 54%" />
<col style="width: 37%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p><strong>PRODUCTO</strong></p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Parámetro</p></td>
<td><p>Descripción</p></td>
<td><p>Ejemplo</p></td>
</tr>
<tr class="row-odd"><td><p><strong>productId</strong></p></td>
<td><p>Número Identificador del producto</p></td>
<td><p>“999990000006710”</p></td>
</tr>
<tr class="row-even"><td><p><strong>Name</strong></p></td>
<td><p>Nombre del producto</p></td>
<td><p>Pizza Barbacoa</p></td>
</tr>
<tr class="row-odd"><td><p><strong>description</strong></p></td>
<td><p>Descripción del contenido del producto</p></td>
<td><p>Masa fresca, bacon, pollo, topping a base de mozzarella, salsa barbacoa y doble de carne de vacuno</p></td>
</tr>
<tr class="row-even"><td><p><strong>Image</strong></p></td>
<td><p>Ruta de la imagen asociada al producto</p></td>
<td><p><a class="reference external" href="http://triton.tel">http://triton.tel</a> epizza.es/nvol/es /content/producto s/pbbq_d.png</p></td>
</tr>
<tr class="row-odd"><td><p><strong>portionsAllowed</strong></p></td>
<td><p>Campo que indica si el producto permite división en porciones o mitades.</p></td>
<td><p>“true”</p></td>
</tr>
<tr class="row-even"><td><p><strong>defaultSizeId</strong></p></td>
<td><p>Número identificador del tamaño por defecto. Este código pertenecerá a uno de los tamaños existentes dentro de listado del campo “sizes[]”</p></td>
<td><p>“20” → Mediana</p></td>
</tr>
<tr class="row-odd"><td><p><strong>maxNumIngredients</strong></p></td>
<td><p>Número máximo de ingredientes adicionales que está permitido añadir a este producto</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p><strong>sizes[]</strong></p></td>
<td><p>Listado de tamaños elegibles del producto. (“Individual”, “Mediana”, “Familiar”, “Strómboli”)</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>defaultIngredients[]</strong></p></td>
<td><p>Listado de ingredientes por defecto que componen el producto. Estos ingredientes podrán ser modificados.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>productBaseSizes[]</strong></p></td>
<td><p>Listado de tipos de bases o formatos de base del producto. En el caso de pizzas, son los tipos de masas que se pueden escoger para el producto.</p>
<p>(“Clásica”, “3 Pisos”, “Fina”,</p>
<p>“Integral” o “QuadRoller”)</p>
</td>
<td></td>
</tr>
</tbody>
</table>
<blockquote>
<div><p>Ejemplo de respuesta:</p>
<p>{</p>
<p>«categories»: [</p>
<p>{</p>
<p>«categoryId»: «999990004923100»,</p>
<p>«name»: «Pizzas»,</p>
<p>«description»: «»,</p>
<p>«subcategories»: [</p>
<p>{</p>
<p>«subcategoryId»: «999990004922538»,</p>
<p>«name»: «Las Clásicas»,</p>
<p>«products»: [</p>
<p>{</p>
<p>«productId»: «999990000006710»,</p>
<p>«name»: «Pizza Barbacoa»,</p>
<p>«description»: «Masa fresca, bacon, pollo, topping a base de
mozzarella, salsa barbacoa y doble de carne de vacuno.»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/nvol/es/content/productos/pbbq_d.png">http://triton.telepizza.es/nvol/es/content/productos/pbbq_d.png</a>»,</p>
<p>«portionsAllowed»: true,</p>
<p>«defaultSizeId»: «20»,</p>
<p>«maxNumIngredients»: 1,</p>
<p>«sizes»: [</p>
<p>{</p>
<p>«sizeId»: «16»,</p>
<p>«name»: «Pequeña»,</p>
<p>«price»: 14.95</p>
<p>},</p>
<p>{</p>
<p>«sizeId»: «20»,</p>
<p>«name»: «Mediana»,</p>
<p>«price»: 20.95</p>
<p>},</p>
<p>{</p>
<p>«sizeId»: «21»,</p>
<p>«name»: «Familiar»,</p>
<p>«price»: 27.95</p>
<p>},</p>
<p>{</p>
<p>«sizeId»: «36»,</p>
<p>«name»: «Strómboli»,</p>
<p>«price»: 20.95</p>
<p>}</p>
<p>],</p>
<p>«defaultIngredients»: [</p>
<p>{</p>
<p>«ingredientId»: «999990005361675»,</p>
<p>«name»: «SALSA BARBACOA»,</p>
<p>«image»:</p>
<p>«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/sbpr.jpg»,</p>
<p>«quantity»: 1,</p>
<p>«groupId»: «1»,</p>
<p>«groupDescription»: «Group 1»</p>
<p>},</p>
<p>{</p>
<p>«ingredientId»: «999990000005700», «name»: «BASE CLÁSICA»,</p>
<p>«image»:</p>
<p>«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/base.jpg»,</p>
<p>«quantity»: 1,</p>
<p>«groupId»: «2»,</p>
<p>«groupDescription»: «Group 2»</p>
<p>},</p>
<p>{</p>
<p>«ingredientId»: «999990005369717», «name»: «Con Topping»,</p>
<p>«image»:</p>
<p>«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/moze.jpg»,</p>
<p>«quantity»: 1,</p>
<p>«groupId»: «3»,</p>
<p>«groupDescription»: «Group 3»</p>
<p>},</p>
<p>{</p>
<p>«ingredientId»: «999990000004466», «name»: «Carne de vacuno»,</p>
<p>«image»:</p>
<p>«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/ca.jpg»,</p>
<p>«quantity»: 1,</p>
<p>«groupId»: «3»,</p>
<p>«groupDescription»: «Group 3»</p>
<p>},</p>
<p>{</p>
<p>«ingredientId»: «999990005436200», «name»: «Bacon»,</p>
<p>«image»:</p>
<p>«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/ca.jpg»,</p>
<p>«quantity»: 1,</p>
<p>«groupId»: «3»,</p>
<p>«groupDescription»: «Group 3»</p>
<p>},</p>
<p>{</p>
<p>«ingredientId»: «999990000004543», «name»: «Pollo marinado»,</p>
<p>«image»:</p>
<p>«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/ca.jpg»,</p>
<p>«quantity»: 1,</p>
<p>«groupId»: «3»,</p>
<p>«groupDescription»: «Group 3»</p>
<p>}</p>
<p>],</p>
<p>«productBaseSizes»: [</p>
<p>{</p>
<p>«productId»: «999990000006710»,</p>
<p>«allowedSizes»: [</p>
<p>«36»,</p>
<p>«20»</p>
<p>]</p>
<p>}</p>
<p>]</p>
<p>},</p>
<p>{</p>
<p>«productId»: «999990000013106»,</p>
<p>«name»: «Pizza Carbonara»,</p>
<p>«description»: null,</p>
<p>«image»: null,</p>
<p>«portionsAllowed»: false,</p>
<p>«defaultSizeId»: null,</p>
<p>«maxNumIngredients»: 0,</p>
<p>«sizes»: null,</p>
<p>«defaultIngredients»: null,</p>
<p>«productBaseSizes»: null</p>
<p>}</p>
<p>]</p>
<p>},</p>
<p>{</p>
<p>«subcategoryId»: «999990004922500»,</p>
<p>«name»: «Las Destacadas»,</p>
<p>«products»: [</p>
<p>{</p>
<p>«productId»: «999990000006814»,</p>
<p>«name»: «A tu gusto»,</p>
<p>«description»: null,</p>
<p>«image»: null,</p>
<p>«portionsAllowed»: false,</p>
<p>«defaultSizeId»: null,</p>
<p>«maxNumIngredients»: 0,</p>
<p>«sizes»: null,</p>
<p>«defaultIngredients»: null,</p>
<p>«productBaseSizes»: null</p>
<p>},</p>
<p>{</p>
<p>«productId»: «999990010533500»,</p>
<p>«name»: «Telepizza Sweet»,</p>
<p>«description»: null,</p>
<p>«image»: null,</p>
<p>«portionsAllowed»: false,</p>
<p>«defaultSizeId»: null,</p>
<p>«maxNumIngredients»: 0,</p>
<p>«sizes»: null,</p>
<p>«defaultIngredients»: null,</p>
<p>«productBaseSizes»: null</p>
<p>}</p>
<p>]</p>
<p>}</p>
<p>]</p>
<p>},</p>
<p>{</p>
<p>«categoryId»: «999990004923100»,</p>
<p>«name»: «Bebidas»,</p>
<p>«description»: «»,</p>
<p>«subcategories»: [</p>
<p>{</p>
<p>«subcategoryId»: «999990004922538»,</p>
<p>«name»: «Refrescos 500 ml»,</p>
<p>«products»: [</p>
<p>{</p>
<p>«productId»: «999990001261600»,</p>
<p>«name»: «Botella Coca-Cola (500ml)»,</p>
<p>«description»: null,</p>
<p>«image»: null,</p>
<p>«portionsAllowed»: false,</p>
<p>«defaultSizeId»: null,</p>
<p>«maxNumIngredients»: 0,</p>
<p>«sizes»: [</p>
<p>{</p>
<p>«sizeId»: «35»,</p>
<p>«name»: «50cl»,</p>
<p>«price»: 1.95</p>
<p>}</p>
<p>],</p>
<p>«defaultIngredients»: null,</p>
<p>«productBaseSizes»: null</p>
<p>}</p>
<p>]</p>
<p>}</p>
<p>]</p>
<p>},</p>
<p>{</p>
<p>«categoryId»: «999990004923110»,</p>
<p>«name»: «Hamburguesas»,</p>
<p>«description»: «El bocado perfecto»,</p>
<p>«subcategories»: [</p>
<p>{</p>
<p>«subcategoryId»: «999990004923634»,</p>
<p>«name»: «Hamburguesas»,</p>
<p>«products»: [</p>
<p>{</p>
<p>«productId»: «999990006381900», «name»: «Nueva Top Burguer Vacuno»,</p>
<p>«description»: null,</p>
<p>«image»: null,</p>
<p>«portionsAllowed»: false,</p>
<p>«defaultSizeId»: null,</p>
<p>«maxNumIngredients»: 0,</p>
<p>«sizes»: [</p>
<p>{</p>
<p>«sizeId»: «4883062663»,</p>
<p>«name»: «Individual»,</p>
<p>«price»: 4.95000029</p>
<p>}</p>
<p>],</p>
<p>«defaultIngredients»: null,</p>
<p>«productBaseSizes»: null</p>
<p>}</p>
<p>]</p>
<p>}</p>
<p>]</p>
<p>}</p>
<p>]</p>
<p>}</p>
<p>GET /catalogue/shop/{ShopId}/{DeliveryType}</p>
</div></blockquote>
<p>Esta llamada se encarga de comenzar un pedido de un kiosco, obteniendo
en su respuesta el catalogo correspondiente,</p>
<blockquote>
<div><p>Los parámetros de entrada son:</p>
</div></blockquote>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 63%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parámetro</p></th>
<th class="head"><p>Descripción</p></th>
<th class="head"><p>Ejemplo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>x-auth-back</strong></p></td>
<td><p>Autorización para el servicio con el token obtenido en la llamada al “POST</p>
<p>/connect/token”:</p>
<p>token_type + “ ” + access_token</p>
</td>
<td><p>“Bearer</p>
<p>eyJhbGciOiJodHRwOi8vd3d3…”</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>ShopId</strong></p></td>
<td><p>Código identificador de la tienda.</p></td>
<td><p>“00145”</p></td>
</tr>
<tr class="row-even"><td><p><strong>DeliveryType</strong></p></td>
<td><p>Código de tipo de reparto. Puede ser 1 ó 3. [1 = local, 3 = recoger]</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p>La respuesta sigue la misma estructura que el punto anterior.</p>
<p>Además del catálogo para una tienda concreta, existen varias llamadas
que se engloban dentro del servicio del catálogo que se encargan de
obtener un producto con todos sus ingredientes a partir de su código, o
también se pueden obtener los ingredientes completos existentes en una
tienda.</p>
<ul class="simple">
<li><p>Obtiene todos los ingredientes elegibles para una tienda GET
/catalogue/choices/shop/{id}</p></li>
<li><p>Obtiene los ingredientes elegibles para un producto en una tienda</p></li>
</ul>
<p>GET /catalogue/shop/{shopId}/product/{productId}/choices</p>
<div class="section" id="obtener-los-ingredientes-elegibles-para-un-producto">
<h3>7.1 Obtener los ingredientes elegibles para un producto<a class="headerlink" href="#obtener-los-ingredientes-elegibles-para-un-producto" title="Enlazar permanentemente con este título">¶</a></h3>
<p>GET /catalogue/shop/{shopId}/product/{productId}/choices</p>
<p>Permite obtener todos los ingredientes que se pueden añadir o elegir
para componer un producto compuesto a partir del identificador del
producto.</p>
<blockquote>
<div><p>Los parámetros de entrada son:</p>
</div></blockquote>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 64%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parámetro</p></th>
<th class="head"><p>Descripción</p></th>
<th class="head"><p>Ejemplo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>x-auth-back</strong></p></td>
<td><p>Autorización para el servicio con el token obtenido en la llamada al “POST</p>
<p>/connect/token”:</p>
<p>token_type + “ ” + access_token</p>
</td>
<td><p>“Bearer</p>
<p>eyJhbGciOiJodHRwOi8vd3d3…”</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>shopId</strong></p></td>
<td><p>Identificador de la tienda</p></td>
<td><p>“00145”</p></td>
</tr>
<tr class="row-even"><td><p><strong>productId</strong></p></td>
<td><p>Identificador del producto</p></td>
<td><p>“999990000006710”</p></td>
</tr>
</tbody>
</table>
<p>El listado devolverá tantas repeticiones del mismo código de producto
como agrupaciones de ingredientes en las que esté incluido el producto
seleccionado. Dentro de cada agrupación estarán incluidos el listado de
ingredientes seleccionables. Estas agrupaciones son una clasificación
por tipo de ingrediente que permite saber la cantidad mínima y máxima de
ingredientes que pueden ser añadidos o no, al producto.</p>
<p>Esta agrupación se podrá utilizar para mostrar en pantalla la
información de estos ingredientes en listados seleccionables u otros
contenedores:</p>
<p><a class="reference internal" href="docs\media/image8.png"><img alt="image3" src="docs\media/image8.png" style="width: 5.70729in; height: 5.40312in;" /></a></p>
<p>Por ejemplo, si el campo mínimo de ingredientes viene informado con un 0
y el de máximo de ingredientes con valor 1, se correspondería con un
ingrediente opcional que puede o no ir incluido. En la imagen anterior
el ejemplo se corresponde con el de: “¿La quieres gratinar?”.</p>
<p>Sin embargo, si el campo de mínimo viene con valor 1 y el de máximo
viene con valor 1, quiere decir que será un elemento obligatorio y a su
vez, llevará un listado de ingredientes para poder elegir uno. En la
imagen anterior, se correspondería con el campo de: “Topping a base de
Mozzarella”.</p>
<p>Otro caso diferente, sería si el campo mínimo viniese con valor 0 y el
máximo con valor 8, implica que son ingredientes opcionales, y como
máximo se podrán añadir 8 ingredientes en total, 8 del mismo tipo u 8 en
total de todos ellos. Por ejemplo, el listado de ingredientes siguiente:</p>
<p><a class="reference internal" href="docs\media/image12.png"><img alt="image4" src="docs\media/image12.png" style="width: 6.93799in; height: 4.81285in;" /></a></p>
<blockquote>
<div><p>Ejemplo de respuesta:</p>
<p>[</p>
<p>{</p>
<p>«productId»: «999990000006710»,</p>
<p>«groupId»: «5147621549»,</p>
<p>«sizeId»: «16»,</p>
<p>«name»: «SALSAS»,</p>
<p>«description»: «SALSAS»,</p>
<p>«groupMinQuantity»: 1,</p>
<p>«groupMaxQuantity»: 1,</p>
<p>«minPerIngredient»: 1,</p>
<p>«maxPerIngredient»: 1,</p>
<p>«ingredients»: [</p>
<p>{</p>
<p>«ingredientId»: «999990005362717»,</p>
<p>«description»: «SALSA BBQ CREME DOBLE»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/2sbc.jpg»
},</p>
<p>{</p>
<p>«ingredientId»: «999990005363000»,</p>
<p>«description»: «SALSA BARBACOA CRÉME»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/sbcr.jpg»
},</p>
<p>{</p>
<p>«ingredientId»: «999990005361909»,</p>
<p>«description»: «SALSA BARBACOA DOBLE»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/2sba.jpg»
},</p>
<p>{</p>
<p>«ingredientId»: «999990005361675»,</p>
<p>«description»: «SALSA BARBACOA»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/sbpr.jpg»
},</p>
<p>{</p>
<p>«ingredientId»: «999990005362799»,</p>
<p>«description»: «SALSA BURGER DOBLE»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/2sbg.jpg»</p>
<p>},</p>
<p>{</p>
<p>«ingredientId»: «999990005363136»,</p>
<p>«description»: «SALSA BURGER»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/sbrg.jpg»
},</p>
<p>{</p>
<p>«ingredientId»: «999990005363775»,</p>
<p>«description»: «SALSA CARBONARA DOBLE»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/2sca.jpg»
},</p>
<p>{</p>
<p>«ingredientId»: «999990005363361»,</p>
<p>«description»: «SALSA CARBONARA»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/scae.jpg»
},</p>
<p>{</p>
<p>«ingredientId»: «999990005363943»,</p>
<p>«description»: «SALSA JALISCO DOBLE»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/2sja.jpg»
},</p>
<p>{</p>
<p>«ingredientId»: «999990005364413»,</p>
<p>«description»: «SALSA JALISCO»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/saje.jpg»
},</p>
<p>{</p>
<p>«ingredientId»: «999990005367124»,</p>
<p>«description»: «SALSA TOMATE Y ORÉGANO DOBLE»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/2sto.jpg»
},</p>
<p>{</p>
<p>«ingredientId»: «999990005365052»,</p>
<p>«description»: «SALSA TOMATE Y ORÉGANO»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/tome.jpg»
},</p>
<p>{</p>
<p>«ingredientId»: «999990002148797»,</p>
<p>«description»: «SIN SALSA»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/0sal.jpg»
}</p>
<p>]</p>
<p>},</p>
<p>{</p>
<p>«productId»: «999990000006710»,</p>
<p>«groupId»: «4940394233», «sizeId»: «16»,</p>
<p>«name»: «¿ALGÚN EXTRA?»,</p>
<p>«description»: «¿ALGÚN EXTRA?»,</p>
<p>«groupMinQuantity»: 1,</p>
<p>«groupMaxQuantity»: 1,</p>
<p>«minPerIngredient»: 1,</p>
<p>«maxPerIngredient»: 1,</p>
<p>«ingredients»: [</p>
<p>{</p>
<p>«ingredientId»: «999990005630501»,</p>
<p>«description»: «–»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/0is.jpg»
},</p>
<p>{</p>
<p>«ingredientId»: «999990005360500»,</p>
<p>«description»: «EXTRA BARBACOA»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/exso.jpg»
},</p>
<p>{</p>
<p>«ingredientId»: «999990005363540»,</p>
<p>«description»: «SALSA CÉSAR (Después de Horno)»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/scep.jpg»
},</p>
<p>{</p>
<p>«ingredientId»: «999990005364597»,</p>
<p>«description»: «SALSA STEAK &amp; GRILL»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/stg.jpg»
},</p>
<p>{</p>
<p>«ingredientId»: «999990005360849»,</p>
<p>«description»: «EXTRA TOMATE CONFITADO»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/extc.jpg»
}</p>
<p>]</p>
<p>},</p>
<p>{</p>
<p>«productId»: «999990000006710»,</p>
<p>«groupId»: «5228699519»,</p>
<p>«sizeId»: «16»,</p>
<p>«name»: «¿LA QUIERES GRATINAR?»,</p>
<p>«description»: «¿LA QUIERES GRATINAR?»,</p>
<p>«groupMinQuantity»: 0,</p>
<p>«groupMaxQuantity»: 1,</p>
<p>«minPerIngredient»: 1,</p>
<p>«maxPerIngredient»: 1,</p>
<p>«ingredients»: [</p>
<p>{</p>
<p>«ingredientId»: «999990002554800»,</p>
<p>«description»: «Gratinado (PVP 2 ingr.)»,</p>
<p>«image»:
«<a class="reference external" href="http://triton.telepizza.es/app/5.0/es/images/ingredients">http://triton.telepizza.es/app/5.0/es/images/ingredients</a>/{density}/grat.jpg»
}</p>
<p>]</p>
<p>}</p>
</div></blockquote>
<p>]</p>
</div>
</div>
<div class="section" id="creacion-del-pedido">
<h2>8. CREACIÓN DEL PEDIDO<a class="headerlink" href="#creacion-del-pedido" title="Enlazar permanentemente con este título">¶</a></h2>
<blockquote>
<div><p>POST /order/create</p>
</div></blockquote>
<p>Esta llamada realiza crea o inicializa el pedido vacío. Este paso es
previo para poder añadir productos, promociones y añadir un medio de
pago, y por lo tanto necesario para poder realizar cualquier pedido. Si
ya había añadidos productos, se inicializa el pedido sin productos ni
promociones.</p>
<blockquote>
<div><p>El parámetro de entrada es:</p>
</div></blockquote>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 64%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parámetro</p></th>
<th class="head"><p>Descripción</p></th>
<th class="head"><p>Ejemplo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>x-auth-back</strong></p></td>
<td><p>Autorización para el servicio con el token obtenido en la llamada al “POST</p>
<p>/connect/token”:</p>
<p>token_type + “ ” + access_token</p>
</td>
<td><p>“Bearer</p>
<p>eyJhbGciOiJodHRwOi8vd3d3…”</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>shopId</strong></p></td>
<td><p>Identificador de la tienda</p></td>
<td><p>“00145”</p></td>
</tr>
<tr class="row-even"><td><p><strong>dateTime</strong></p></td>
<td><p>Fecha seleccionada para recogida o entrega del pedido.</p></td>
<td><p>“2019-05-24T12:09:00.094Z”</p></td>
</tr>
</tbody>
</table>
<p>La respuesta vendrá vacía si ha ido todo bien (con un código de
respuesta “204 – NoContent”).</p>
<blockquote>
<div><p>POST /order/createlocal</p>
</div></blockquote>
<p>Esta llamada realiza crea o inicializa el pedido vacío. Este paso es
previo para poder añadir productos, promociones y añadir un medio de
pago, y por lo tanto necesario para poder realizar cualquier pedido. Si
ya había añadidos productos, se inicializa el pedido sin productos ni
promociones.</p>
<blockquote>
<div><p>El parámetro de entrada es:</p>
</div></blockquote>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 64%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parámetro</p></th>
<th class="head"><p>Descripción</p></th>
<th class="head"><p>Ejemplo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>x-auth-back</strong></p></td>
<td><p>Autorización para el servicio con el token obtenido en la llamada al “POST</p>
<p>/connect/token”:</p>
<p>token_type + “ ” + access_token</p>
</td>
<td><p>“Bearer</p>
<p>eyJhbGciOiJodHRwOi8vd3d3…”</p>
</td>
</tr>
</tbody>
</table>
<p>La respuesta vendrá vacía si ha ido todo bien (con un código de
respuesta “204 – NoContent”).</p>
</div>
<div class="section" id="anadir-un-producto">
<h2>9. AÑADIR UN PRODUCTO<a class="headerlink" href="#anadir-un-producto" title="Enlazar permanentemente con este título">¶</a></h2>
<blockquote>
<div><p>POST /order/product</p>
</div></blockquote>
<p>Esta llamada permite agregar un producto a un pedido ya existente, que
este pedido esté vacío o que contenga otros productos incluidos en él.</p>
<p>El producto de entrada puede ser un producto simple como una bebida que
no contiene ingredientes elegibles o seleccionables o un producto
compuesto (ejemplo: pizza) que contiene ingredientes por defecto y
también otros ingredientes que se pueden ir agregando según una lista.</p>
<blockquote>
<div><p>Los parámetros de entrada son:</p>
</div></blockquote>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 59%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parámetro</p></th>
<th class="head"><p>Descripción</p></th>
<th class="head"><p>Ejemplo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>x-auth-back</strong></p></td>
<td><p>Autorización para el servicio con el token obtenido en la llamada al</p>
<p>“POST /connect/token”:</p>
<p>token_type + “ ” + access_token</p>
</td>
<td><p>“Bearer</p>
<p>eyJhbGciOiJodHRwOi8vd3d3…”</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>product[]</strong></p></td>
<td><p>Información del producto que se desea añadir al pedido.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>size</strong></p></td>
<td><p>Código identificador del tamaño</p></td>
<td><p>Mediana → “20”</p></td>
</tr>
<tr class="row-odd"><td><p><strong>units</strong></p></td>
<td><p>Cantidad de unidades del mismo producto</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p><strong>producto[]</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>products[]</strong></p></td>
<td><p>Listado de productos con sus ingredientes y elecciones que se añadirán al pedido.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 28%" />
<col style="width: 59%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>products[]</strong></p></th>
<th class="head"></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>partialProductId</strong></p></td>
<td><p>Código identificador del producto</p></td>
<td><p>“999990000006710”</p></td>
</tr>
<tr class="row-odd"><td><p><strong>name</strong></p></td>
<td><p>Nombre del producto</p></td>
<td><p>“Pizza Barbacoa”</p></td>
</tr>
<tr class="row-even"><td><p><strong>description</strong></p></td>
<td><p>Descripción breve del producto</p></td>
<td><p>“Masa fresca, bacon, pollo, topping a base de mozzarella, salsa barbacoa y doble de carne de vacuno.”</p></td>
</tr>
<tr class="row-odd"><td><p><strong>choices[]</strong></p></td>
<td><p>Listado de ingredientes elegibles para el producto</p></td>
<td></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 61%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p><strong>choices[]</strong></p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>choiceId</strong></p></td>
<td><p>Identificador del ingrediente que se incluirá dentro del producto</p></td>
<td><p>“999990005365052”</p></td>
</tr>
<tr class="row-odd"><td><p><strong>name</strong></p></td>
<td><p>Nombre del ingrediente</p></td>
<td><p>“SALSA TOMATE Y ORÉGANO”</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><p>Ejemplo de parámetros de entrada:</p>
<p>{</p>
<p>«products»: [</p>
<p>{</p>
<p>«name»: «Bacon Crispy Gourmet»,</p>
<p>«description»: «»,</p>
<p>«partialproductid»: «999990010908732»,</p>
<p>«choices»: [</p>
<p>{</p>
<p>«choiceid»: «999990005263746»,</p>
<p>«name»: «BASE FINA»</p>
<p>},</p>
<p>{</p>
<p>«choiceid»: «999990010517817»,</p>
<p>«name»: «5 Quesos Gourmet»</p>
<p>},</p>
<p>{</p>
<p>«choiceid»: «999990006472065»,</p>
<p>«name»: «Fina masa»</p>
<p>},</p>
<p>{</p>
<p>«choiceid»: «999990010429777»,</p>
<p>«name»: «Salsa Barbacoa»</p>
<p>},</p>
<p>{</p>
<p>«choiceid»: «999990010902209»,</p>
<p>«name»: «Topping a Base de Mozzarella»</p>
<p>},</p>
<p>{</p>
<p>«choiceid»: «999990010905260»,</p>
<p>«name»: «Bacon»</p>
<p>},</p>
<p>{</p>
<p>«choiceid»: «999990010902269»,</p>
<p>«name»: «Bacon Crispy»</p>
<p>}</p>
<p>]</p>
<p>}</p>
<p>],</p>
<p>«size»: 20,</p>
<p>«units»: 2</p>
<p>}</p>
</div></blockquote>
<p>La respuesta de esta llamada devolverá el pedido actual completo con
todos los productos que se han añadido hasta el momento.</p>
<blockquote>
<div><p>Ejemplo de respuesta:</p>
<p>{</p>
<p>«customerEmail»: null,</p>
<p>«deliveryOrder»: null,</p>
<p>«cartDto»: {</p>
<p>«products»: [</p>
<p>{</p>
<p>«products»: [</p>
<p>{</p>
<p>«name»: «Bacon Crispy Gourmet»,</p>
<p>«description»: «Si eres fan del bacon, aquí tienes ración doble:
ahumado y crispy.</p>
<p>Una sabrosa mezcla acompañada por nuestra tradicional salsa barbacoa
y la doble masa rellena de 5 quesos.»,</p>
<p>«partialProductId»: «999990010908732»,</p>
<p>«choices»: [</p>
<p>{</p>
<p>«choiceId»: «999990005263746»,</p>
<p>«name»: «BASE FINA BFP»</p>
<p>},</p>
<p>{</p>
<p>«choiceId»: «999990010517817»,</p>
<p>«name»: «5 Quesos Gourmet»</p>
<p>},</p>
<p>{</p>
<p>«choiceId»: «999990006472065»,</p>
<p>«name»: «Fina masa»</p>
<p>},</p>
<p>{</p>
<p>«choiceId»: «999990010429777»,</p>
<p>«name»: «Salsa Barbacoa»</p>
<p>},</p>
<p>{</p>
<p>«choiceId»: «999990010902209»,</p>
<p>«name»: «Topping a Base de Mozzarella»</p>
<p>},</p>
<p>{</p>
<p>«choiceId»: «999990010905260»,</p>
<p>«name»: «Bacon»</p>
<p>},</p>
<p>{</p>
<p>«choiceId»: «999990010902269»,</p>
<p>«name»: «Bacon Crispy»</p>
<p>}</p>
<p>]</p>
<p>}</p>
<p>],</p>
<p>«size»: 0,</p>
<p>«units»: 1,</p>
<p>«price»: 23,</p>
<p>«productLineId»: 1</p>
<p>},</p>
<p>{</p>
<p>«products»: [</p>
<p>{</p>
<p>«name»: «Bacon Crispy Gourmet»,</p>
<p>«description»: «Si eres fan del bacon, aquí tienes ración doble:
ahumado y crispy.</p>
<p>Una sabrosa mezcla acompañada por nuestra tradicional salsa barbacoa
y la doble masa rellena de 5 quesos.»,</p>
<p>«partialProductId»: «999990010908732»,</p>
<p>«choices»: [</p>
<p>{</p>
<p>«choiceId»: «999990005263746»,</p>
<p>«name»: «BASE FINA BFP»</p>
<p>},</p>
<p>{</p>
<p>«choiceId»: «999990010517817»,</p>
<p>«name»: «5 Quesos Gourmet»</p>
<p>},</p>
<p>{</p>
<p>«choiceId»: «999990006472065»,</p>
<p>«name»: «Fina masa»</p>
<p>},</p>
<p>{</p>
<p>«choiceId»: «999990010429777»,</p>
<p>«name»: «Salsa Barbacoa»</p>
<p>},</p>
<p>{</p>
<p>«choiceId»: «999990010902209»,</p>
<p>«name»: «Topping a Base de Mozzarella»</p>
<p>},</p>
<p>{</p>
<p>«choiceId»: «999990010905260»,</p>
<p>«name»: «Bacon»</p>
<p>},</p>
<p>{</p>
<p>«choiceId»: «999990010902269»,</p>
<p>«name»: «Bacon Crispy»</p>
<p>}</p>
<p>]</p>
<p>}</p>
<p>],</p>
<p>«size»: 0,</p>
<p>«units»: 1,</p>
<p>«price»: 23,</p>
<p>«productLineId»: 2</p>
<p>}</p>
<p>],</p>
<p>«originalPrice»: 45.9,</p>
<p>«totalPrice»: 45.9,</p>
<p>«promotions»: []</p>
<p>},</p>
<p>«creationDate»: «0001-01-01T00:00:00»</p>
</div></blockquote>
<p>}</p>
</div>
<div class="section" id="establecer-una-direccion-de-entrega">
<h2>10. ESTABLECER UNA DIRECCIÓN DE ENTREGA<a class="headerlink" href="#establecer-una-direccion-de-entrega" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Para establecer una dirección de entrega, es necesario hacer dos
llamadas a los siguientes endpoints:</p>
<blockquote>
<div><p>GET /order/getaddress</p>
</div></blockquote>
<p>Esta llamada se encarga de obtener la información necesaria para
establecer la dirección de entrega.</p>
<blockquote>
<div><p>Los parámetros de entrada son:</p>
</div></blockquote>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 59%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parámetro</p></th>
<th class="head"><p>Descripción</p></th>
<th class="head"><p>Ejemplo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>x-auth-back</strong></p></td>
<td><p>Autorización para el servicio con el token obtenido en la llamada al</p>
<p>“POST /connect/token”: token_type + “ ” + access_token</p>
</td>
<td><p>“Bearer</p>
<p>eyJhbGciOiJodHRwOi8vd3d3…”</p>
</td>
</tr>
</tbody>
</table>
<blockquote>
<div><p>Los parámetros de salida son:</p>
</div></blockquote>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 75%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parámetro</p></th>
<th class="head"><p>Descripción</p></th>
<th class="head"><p>Ejemplo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>primaryField[]</strong></p></td>
<td><p>Campos adicionales para identificar el domicilio del cliente (Portal, Piso, Letra, etc.)</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>secondaryField[]</strong></p></td>
<td><p>Campos adicionales para identificar el domicilio del cliente (Portal, Piso, Letra, etc.)</p></td>
<td></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 75%" />
<col style="width: 11%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p><strong>primaryField[], secondaryField[]</strong></p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>key</strong></p></td>
<td><p>Identificador del campo</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p><strong>label</strong></p></td>
<td><p>Nombre que identifica el campo que se va a informar en el “value”</p></td>
<td><p>“Letra”</p></td>
</tr>
<tr class="row-even"><td><p><strong>value</strong></p></td>
<td><p>Valor asociado al campo “label”</p></td>
<td><p>“A”</p></td>
</tr>
<tr class="row-odd"><td><p><strong>maxLenght</strong></p></td>
<td><p>Longitud máxima de caracteres que tendrá el campo “value”.</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p><strong>editable</strong></p></td>
<td><p>Si el campo value se puede editar o no (True o False)</p></td>
<td><p>True</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><p>Ejemplo de respuesta:</p>
<p>{</p>
<p>«primaryField»: [</p>
<p>{</p>
<p>«key»: «county»,</p>
<p>«label»: «Provincia»,</p>
<p>«value»: «ZARAGOZA»,</p>
<p>«editable»: false,</p>
<p>«maxLength»: -1</p>
<p>},</p>
<p>{</p>
<p>«key»: «city»,</p>
<p>«label»: «Localidad»,</p>
<p>«value»: «ZARAGOZA»,</p>
<p>«editable»: false,</p>
<p>«maxLength»: -1</p>
<p>},</p>
<p>{</p>
<p>«key»: «street»,</p>
<p>«label»: «Nombre de vía»,</p>
<p>«value»: «CALLE JULIO CORTAZAR»,</p>
<p>«editable»: true,</p>
<p>«maxLength»: -1</p>
<p>},</p>
<p>{</p>
<p>«key»: «house_number»,</p>
<p>«label»: «Número»,</p>
<p>«value»: «19»,</p>
<p>«editable»: true,</p>
<p>«maxLength»: -1</p>
<p>}</p>
<p>],</p>
<p>«secondaryField»: [</p>
<p>{</p>
<p>«key»: null,</p>
<p>«label»: «Bloque»,</p>
<p>«value»: null,</p>
<p>«editable»: true,</p>
<p>«maxLength»: 5</p>
<p>},</p>
<p>{</p>
<p>«key»: null,</p>
<p>«label»: «Escalera»,</p>
<p>«value»: null,</p>
<p>«editable»: true,</p>
<p>«maxLength»: 3</p>
<p>},</p>
<p>{</p>
<p>«key»: null,</p>
<p>«label»: «Piso»,</p>
<p>«value»: null,</p>
<p>«editable»: true,</p>
<p>«maxLength»: 3</p>
<p>},</p>
<p>{</p>
<p>«key»: null,</p>
<p>«label»: «Puerta»,</p>
<p>«value»: null,</p>
<p>«editable»: true,</p>
<p>«maxLength»: 3</p>
<p>}</p>
<p>] }</p>
<p>POST /order/delivery</p>
</div></blockquote>
<p>Esta llamada se encarga de establecer una dirección de entrega al pedido
en curso.</p>
<blockquote>
<div><p>Los parámetros de entrada son:</p>
</div></blockquote>
<table class="docutils align-default">
<colgroup>
<col style="width: 11%" />
<col style="width: 74%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parámetro</p></th>
<th class="head"><p>Descripción</p></th>
<th class="head"><p>Ejemplo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>x-auth-back</strong></p></td>
<td><p>Autorización para el servicio con el token obtenido en la llamada al “POST /connect/token”: token_type + “ ” + access_token</p></td>
<td><p>“Bearer</p>
<p>eyJhbGciOiJodHRwOi8vd3d3…”</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>deliveryOrder[]</strong></p></td>
<td><p>Información asociada al reparto del pedido</p></td>
<td></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 74%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>deliveryInputOrder[]</strong></p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>phone</strong></p></td>
<td><p>Teléfono del cliente</p></td>
</tr>
<tr class="row-odd"><td><p><strong>deliveryObservations</strong></p></td>
<td><p>Notas que se tendrán en cuenta a la hora de realizar el reparto.</p></td>
</tr>
<tr class="row-even"><td><p><strong>address[]</strong></p></td>
<td><p>Dirección del cliente donde se repartirá el pedido</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p><strong>address[]</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>primaryField[]</strong></p></td>
<td><p>Campos adicionales para identificar el domicilio del cliente (Portal, Piso, Letra, etc.)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>secondaryField[]</strong></p></td>
<td><p>Campos adicionales para identificar el domicilio del cliente (Portal, Piso, Letra, etc.)</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 75%" />
<col style="width: 11%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p><strong>primaryField[], secondaryField[]</strong></p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>key</strong></p></td>
<td><p>Identificador del campo</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p><strong>label</strong></p></td>
<td><p>Nombre que identifica el campo que se va a informar en el “value”</p></td>
<td><p>“Letra”</p></td>
</tr>
<tr class="row-even"><td><p><strong>value</strong></p></td>
<td><p>Valor asociado al campo “label”</p></td>
<td><p>“A”</p></td>
</tr>
<tr class="row-odd"><td><p><strong>maxLenght</strong></p></td>
<td><p>Longitud máxima de caracteres que tendrá el campo “value”.</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p><strong>editable</strong></p></td>
<td><p>Si el campo value se puede editar o no (True o False)</p></td>
<td><p>True</p></td>
</tr>
</tbody>
</table>
<p>Ejemplo de parámetros de entrada:</p>
<p>{</p>
<p>«Phone»: «943546576»,</p>
<p>«deliveryObservations»: «Sin observaciones»,</p>
<p>«address»: {</p>
<p>«primaryfield»: [</p>
<p>{</p>
<p>«key»: «county»,</p>
<p>«label»: «Provincia»,</p>
<p>«value»: «ZARAGOZA»,</p>
<p>«editable»: false,</p>
<p>«max_length»: -1</p>
<p>},</p>
<p>{</p>
<p>«key»: «city»,</p>
<p>«label»: «Localidad»,</p>
<p>«value»: «ZARAGOZA»,</p>
<p>«editable»: false,</p>
<p>«max_length»: -1</p>
<p>},</p>
<p>{</p>
<p>«key»: «street»,</p>
<p>«label»: «Nombre de vía»,</p>
<p>«value»: «CALLE EMILIA PARDO BAZAN», «editable»: true,</p>
<p>«max_length»: -1</p>
<p>},</p>
<p>{</p>
<p>«key»: «house_number»,</p>
<p>«label»: «Número»,</p>
<p>«value»: «22»,</p>
<p>«editable»: true,</p>
<p>«max_length»: -1</p>
<p>}</p>
<p>],</p>
<p>«secondaryfield»: [</p>
<p>{</p>
<p>«key»: null,</p>
<p>«label»: «Bloque»,</p>
<p>«value»: «1»,</p>
<p>«editable»: true,</p>
<p>«max_length»: 5</p>
<p>},</p>
<p>{</p>
<p>«key»: null,</p>
<p>«label»: «Escalera»,</p>
<p>«value»: «3»,</p>
<p>«editable»: true,</p>
<p>«max_length»: 3</p>
<p>},</p>
<p>{</p>
<p>«key»: null,</p>
<p>«label»: «Piso»,</p>
<p>«value»: «5»,</p>
<p>«editable»: true,</p>
<p>«max_length»: 3</p>
<p>},</p>
<p>{</p>
<p>«key»: null,</p>
<p>«label»: «Puerta»,</p>
<p>«value»: «D»,</p>
<p>«editable»: true,</p>
<p>«max_length»: 3</p>
<p>}</p>
<p>]</p>
<p>}</p>
<p>}</p>
</div>
<div class="section" id="obtener-medios-de-pago">
<h2>11. OBTENER MEDIOS DE PAGO<a class="headerlink" href="#obtener-medios-de-pago" title="Enlazar permanentemente con este título">¶</a></h2>
<blockquote>
<div><p>GET /shop/{id}/payments</p>
</div></blockquote>
<p>Esta llamada permite obtener un listado de los diferentes medios de pago
que permite una tienda en concreto por medio del identificador de la
tienda.</p>
<p>Los parámetros de entrada son:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 64%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parámetro</p></th>
<th class="head"><p>Descripción</p></th>
<th class="head"><p>Ejemplo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>x-auth-back</strong></p></td>
<td><p>Autorización para el servicio con el token obtenido en la llamada al “POST</p>
<p>/connect/token”:</p>
<p>token_type + “ ” + access_token</p>
</td>
<td><p>“Bearer</p>
<p>eyJhbGciOiJodHRwOi8vd3d3…”</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>id</strong></p></td>
<td><p>Número que identifica la tienda en nuestro sistema.</p></td>
<td><p>“00145”</p></td>
</tr>
</tbody>
</table>
<p>Como resultado se obtendrá un listado con los medios de pago disponibles
para la tienda que se desea consultar.</p>
<blockquote>
<div><p>Los parámetros de salida son:</p>
</div></blockquote>
<table class="docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 70%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parámetro</p></th>
<th class="head"><p>Descripción</p></th>
<th class="head"><p>Ejemplo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>electronicPaymentId</strong></p></td>
<td><p>Identificador del medio de pago</p></td>
<td><p>“1”</p></td>
</tr>
<tr class="row-odd"><td><p><strong>paymentTypeName</strong></p></td>
<td><p>Nombre del medio de pago elegido</p></td>
<td><p>“Efectivo Euros”</p></td>
</tr>
<tr class="row-even"><td><p><strong>changeEfective[]</strong></p></td>
<td><p>En caso de seleccionar el tipo de pago del pedido en Efectivo, devuelve un listado con el cambio, en monedas o billetes, que dispondrá el repartidor como máximo para afrontar el pago.</p></td>
<td><p>“10”</p>
<p>(El repartidor sólo llevará 10€ de cambio como máximo)</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>isExternalPayment</strong></p></td>
<td><p>Indica si el un medio de pago externo o medio de pago electrónico. (True o False)</p></td>
<td><p>false</p></td>
</tr>
<tr class="row-even"><td><p><strong>tokenType</strong></p></td>
<td><p>0 -&gt; Medio de pago no Tokenizable. 1 -&gt; Tokenizable con restricciones por usuario.</p>
<p>2 -&gt; Tokenizable</p>
</td>
<td><p>0</p></td>
</tr>
</tbody>
</table>
<p><strong>El campo tokenType</strong>: este campo es relativo a la propiedad de
“billing_agreement” de la pasarela de pagos y vendrá definida por un
checkbox que el usuario pueda marcar cuando vaya a pagar, en la pantalla
de selección de medio de pago. Es importante definir los casos en los
que dicho checkbox estará disponible o no para ser marcado por el
usuario. Por esta razón se dispondrá de una propiedad numérica
denominada “<strong>tokenType</strong>” al momento de pedir la información de los
medios de pago de la tienda.</p>
<p>Los posibles valores que puede tomar este campo, y lo que representa
cada uno, son:</p>
<ul class="simple">
<li><p><strong>Valor numérico 0</strong>: El medio de pago <strong>NO es tokenizable</strong>, por lo
tanto el checkbox no debería poder usarse. Esto implica que al llamar
a la pasarela el campo “billing_agreement” debería ser False.</p></li>
<li><p><strong>Valor numérico 1</strong>: El medio de pago <strong>SÍ es tokenizable PERO con
una restricción</strong>. Esta restricción consiste en que solamente se
puede guardar un único token para este medio de pago por usuario.</p></li>
</ul>
<blockquote>
<div><p>Esto significa que para saber si el checkbox debe estar disponible
para el usuario hay que, primero, revisar si dicho usuario tiene
tokens asociados a ese medio de pago (lo cual se conoce a través de
la llamada a “<em>GET /customer/{id}/allpayments</em>”) y, si no tiene
ninguno, tendrá el checkbox disponible. Mientras que si tiene algún
token asociado a dicho medio de pago el checkbox no estará disponible
para el usuario. El campo “billing_agreement” que se utiliza al
llamar a la pasarela deberá ser False para este segundo caso;
mientras que, por otro lado, será dependiente de que el checkbox esté
marcado o desmarcado para pasar un True o False en el primer caso.</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>Valor numérico 2</strong>: El medio de pago <strong>SÍ es tokenizable</strong> y sin
restricciones, por lo tanto, el checkbox debería estar activo siempre
que se selecciona un medio de pago con este tipo de token. El campo
“billing_agreement” que se utiliza al llamar a la pasarela es
entonces dependiente de que el checkbox esté marcado o desmarcado
para pasar un True o False respectivamente.</p></li>
</ul>
<blockquote>
<div><p>Ejemplo de respuesta:</p>
<p>[</p>
<p>{</p>
<p>«electronicPaymentId»: «1»,</p>
<p>«paymentTypeName»: «Efectivo Euros»,</p>
<p>«changeEfective»: [</p>
<p>10,</p>
<p>20,</p>
<p>30,</p>
<p>40</p>
<p>],</p>
<p>«isExternalPayment»: false,</p>
<p>«tokenType»: 0</p>
<p>},</p>
<p>{</p>
<p>«electronicPaymentId»: «2»,</p>
<p>«paymentTypeName»: «Tarjeta»,</p>
<p>«changeEfective»: null,</p>
<p>«isExternalPayment»: false,</p>
<p>«tokenType»: 0</p>
<p>} ]</p>
</div></blockquote>
</div>
<div class="section" id="finalizar-pedido">
<h2>12. FINALIZAR PEDIDO<a class="headerlink" href="#finalizar-pedido" title="Enlazar permanentemente con este título">¶</a></h2>
<blockquote>
<div><p>POST /order/save</p>
<p>POST /order/savelocal</p>
</div></blockquote>
<p>Por medio de esta llamada se permite finalizar el pedido (básico o de
kiosco) realizando el pago mediante el medio de pago en concreto.</p>
<blockquote>
<div><p>Los parámetros de entrada son:</p>
</div></blockquote>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 72%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parámetro</p></th>
<th class="head"><p>Descripción</p></th>
<th class="head"><p>Ejemplo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>x-auth-back</strong></p></td>
<td><p>Autorización para el servicio con el token obtenido en la llamada al “POST /connect/token”: token_type + “ ” + access_token</p></td>
<td><p>“Bearer</p>
<p>eyJhbGciOiJodHRwOi8vd3d3…”</p>
</td>
</tr>
<tr class="row-odd"><td><p><strong>paymentType</strong></p></td>
<td><p>Tipo de medio de pago con el que se va a realizar el pago del pedido.</p>
<p>Cash = 1,</p>
<p>TicketRestaurant = 4,</p>
<p>Dataphone = 16, PayPal = 20,</p>
<p>ConexFlow = 21,</p>
<p>Kuapay = 25,</p>
<p>WebPay = 26,</p>
<p>Iuapay = 27, PayU = 28,</p>
<p>RedSys = 32,</p>
<p>PayMe = 33,</p>
<p>PayTPV = 43</p>
</td>
<td><p>“1”</p></td>
</tr>
<tr class="row-even"><td><p><strong>digitCard</strong></p></td>
<td><p>Número de tarjeta de crédido, solo sí se selecciona el medio de pago Tarjeta de Crédito en el campo “paymentType”</p></td>
<td><p>vacío</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Token</strong></p></td>
<td><p>Cadena identificativa del pago electrónico</p></td>
<td><p>vacío</p></td>
</tr>
<tr class="row-even"><td><p><strong>clientCash</strong></p></td>
<td><p>Cambio de dinero en efectivo que tendrá que disponer el repartidor para el pago del pedido en efectivo y entrega a domicilio.</p></td>
<td><p>“50”</p></td>
</tr>
<tr class="row-odd"><td><p><strong>OrderObservations</strong></p></td>
<td><p>Notas de elaboración del pedido</p></td>
<td></td>
</tr>
</tbody>
</table>
<blockquote>
<div><p>Ejemplo de parámetros de entrada:</p>
<p>{</p>
<p>«paymentType»: 1,</p>
<p>«digitCard»: null,</p>
<p>«token»: null,</p>
<p>«clientcash»: 50,</p>
<p>«OrderObservations»: «Sin observaciones»</p>
<p>}</p>
</div></blockquote>
<p>La respuesta al grabar el pedido contendrá la información de la tienda
que suministra los productos, los datos relevantes de la dirección de
entrega junto con el precio del pedido, el coste de reparto y la hora de
reparto.</p>
<blockquote>
<div><p>Ejemplo de respuesta:</p>
<p>{
«orderId»: «12»,
«deliveryNoteId»: «501»,
«address»: «»,
«shopAddress»: «Virgen de Aranzazu 33»,
«orderObservations»: «Sin observaciones»,
«totalPrice»: 20.95,
«deliveryCost»: 12.3,
«email»: «<a class="reference external" href="mailto:marcelino&#37;&#52;&#48;pan&#46;vino">marcelino<span>&#64;</span>pan<span>&#46;</span>vino</a>»,
«deliveryTime»: «2019-04-25T16:45:34.6696507+00:00»,
«shopPhone»: «914544567»
}</p>
</div></blockquote>
</div>
</div>


	    </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="orderflow_2.html" class="btn btn-neutral float-right" title="ORDERFLOW">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral" title="Welcome to techDocTLPZ’s documentation!"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Thorvaldur Konradsson.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/jucacrispim/sphinx_pdj_theme">theme</a> provided by <a href="http://poraodojuca.net">Porão do Juca</a>.

</footer>
	</div>
	</div>
	  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.0.1.a',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
    <script type="text/javascript" src="../_static/jquery.js">

    </script>
    <script type="text/javascript" src="../_static/underscore.js">

    </script>
    <script type="text/javascript" src="../_static/doctools.js">

    </script>
    <script type="text/javascript" src="../_static/language_data.js">

    </script>
    <script type="text/javascript" src="../_static/translations.js">

    </script>

  

   <script type="text/javascript"
           src="../_static/js/theme.js"></script>

   <script type="text/javascript"
           src="../_static/js/pdj.js"></script>

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

  </body>
</html>